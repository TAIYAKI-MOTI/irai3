<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
    </head>
    <body>
        <script>
            function base64Encode(...parts) {
                return new Promise(resolve => {
                    const reader = new FileReader();
                    reader.onload = () => {
                    const offset = reader.result.indexOf(",") + 1;
                    resolve(reader.result.slice(offset));
                    };
                    reader.readAsDataURL(new Blob(parts));
                });
            }

            function base64Decode(text, charset) {
                return fetch(`data:text/plain;charset=${charset};base64,` + text).then(response => response.text());
            }

            function base64DecodeAsBlob(text, type = "text/plain;charset=UTF-8") {
                return fetch(`data:${type};base64,` + text).then(response => response.blob());
            } 

            // data:text/plain;charset=utf8;base64,bXluYW1lJTNEVE9UQSUyQ3lvdXJuYW1lJTNES09STw==
            const a = document.createElement('textarea');
            a.name="input"
            document.body.appendChild(a);
            const d = document.createElement('label');
            d.innerHTML="入力";
            d.htmlFor="input";
            document.body.appendChild(d);
            const c = document.createElement('br');
            document.body.append(c);
            const b = document.createElement('p')
            document.body.appendChild(b);
            
            const e = async ()=>{
                const decoded = decodeURIComponent(await base64Decode(a.value,"utf8"));
                b.innerText=decoded;
            };
            a.addEventListener('change', e);
            const f = document.createElement('button');
            f.innerText="変換";
            document.body.appendChild(f);
            f.addEventListener('click', e);
            //<iframe src=""></iframe>
            const g = document.createElement('iframe');
            g.src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSaXWzSUI9uD4JnW_Ojwmedf34sKNddhAguuGeBLDMvw4vW68yYbBIb1-tv0ZZVatkcj7pCO3oVgdZP/pubhtml?gid=1274224821&amp;single=true&amp;widget=true&amp;headers=false"
            document.appendChild(g);
        </script>
        
    </body>
</html>